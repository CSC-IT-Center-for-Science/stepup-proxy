<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
	xmlns:c="http://www.springframework.org/schema/c" xmlns:p="http://www.springframework.org/schema/p"
	xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
                        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd"
	default-init-method="initialize" default-destroy-method="destroy">



	<bean
		class="org.springframework.context.support.PropertySourcesPlaceholderConfigurer"
		p:placeholderPrefix="%{" p:placeholderSuffix="}" />

	<bean id="AttachOidcAuthenticationRequest" class="fi.csc.idp.stepup.impl.AttachOidcAuthenticationRequest"
		scope="prototype" p:issuer="MyIssuerValue">
	</bean>

	<bean id="VerifyClientRedirectUriOfOidcAuthenticationRequest"
		class="fi.csc.idp.stepup.impl.VerifyClientRedirectUriOfOidcAuthenticationRequest"
		scope="prototype">
		<property name="RedirectUris">
			<map>
				<entry>
					<key>
						<value>foo</value>
					</key>
					<list>
						<value>https://foo.bar/idp/Authn/SocialUserOpenIdConnectEnd
						</value>
					</list>
				</entry>
				<entry>
					<key>
						<value>foo2</value>
					</key>
					<list>
						<value>https://foo2.bar/idp/Authn/SocialUserOpenIdConnectEnd
						</value>
					</list>
				</entry>
			</map>
		</property>
	</bean>

	<bean id="ValidateRequestObjectOfOidcAuthenticationRequest"
		class="fi.csc.idp.stepup.impl.ValidateRequestObjectOfOidcAuthenticationRequest"
		scope="prototype" p:noSignatureVerify="false">
		<property name="JwkSetUris">
			<map>
				<entry key="foo" value="https://foo.bar/keyset/mfaclientkeyset.jwk" />
				<entry key="foo2" value="https://foo2.bar/keyset/mfaclientkeyset.jwk" />
			</map>
		</property>
	</bean>

	<bean id="BuildShibbolethContexts" class="fi.csc.idp.stepup.impl.BuildShibbolethContexts"
		scope="prototype">
		<property name="claimToAttribute">
			<map>
				<entry key="eppn" value="INTeppn" />
				<entry key="mobile" value="INTmobile" />
			</map>
		</property>
	</bean>

	<bean id="RespondOidcMFARequest" class="fi.csc.idp.stepup.impl.RespondOidcMFARequest"
		scope="prototype" p:privKey-ref="JWTPrivateKey">
		<property name="tokenResponseClaims">
			<list>
				<value>eppn</value>
				<value>mobile</value>
			</list>
		</property>
	</bean>

	<bean id="JWTPrivateKey" class="net.shibboleth.ext.spring.factory.PrivateKeyFactoryBean"
		p:resource="../../../credentials/oidcjwkprivatekey.pem" />

</beans>
